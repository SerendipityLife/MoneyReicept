import{a as V}from"./chunk-JHTPU5XN.js";import{B as Dt,K as Mt,M as vt,O as wt,R as It,S as St,a as _t,i as Pt,l as ht,s as ft,w as xt,x as yt}from"./chunk-BXN76OUI.js";import{Ba as J,Cb as q,Da as B,Db as tt,E as a,Ea as N,F,Gb as et,H as K,Kb as nt,L as P,Lb as it,P as s,Pa as W,Q as c,Qa as z,R as d,S as w,Sb as ot,Tb as rt,Ua as L,W as x,X as S,Xb as at,Y as p,Yb as ct,_b as dt,bc as st,dc as lt,f as _,fa as u,ga as y,gc as ut,ha as D,hc as pt,ic as mt,ka as b,la as E,lc as gt,ma as O,mc as Ct,ob as G,pb as H,qb as Q,r as T,rb as X,sb as Y,t as A,va as $,w as h,wa as j,x as f,yb as Z}from"./chunk-TEVF6OOM.js";import{a as M,b as v,e as m}from"./chunk-JHI3MBHO.js";var Et=(()=>{let r=class r{constructor(t){this.http=t,this.apiUrl=`${V.apiUrl}/api/product-images`}uploadAndAnalyzeProduct(t){return m(this,null,function*(){let e=new FormData;e.append("image",t);try{return yield _(this.http.post(`${this.apiUrl}/analyze`,e))}catch(n){throw console.error("Product upload failed:",n),n}})}uploadProductFromDataUrl(t,e="product.jpg"){return m(this,null,function*(){let l=yield(yield fetch(t)).blob(),g=new File([l],e,{type:l.type});return this.uploadAndAnalyzeProduct(g)})}saveProduct(t){return m(this,null,function*(){try{return(yield _(this.http.post(`${this.apiUrl}/save`,t))).data}catch(e){throw console.error("Failed to save product:",e),e}})}getProductGallery(t){return m(this,null,function*(){let e=new B;t.category&&(e=e.set("category",t.category)),t.brand&&(e=e.set("brand",t.brand)),t.startDate&&(e=e.set("startDate",t.startDate.toISOString())),t.endDate&&(e=e.set("endDate",t.endDate.toISOString())),t.minConfidence!==void 0&&(e=e.set("minConfidence",t.minConfidence.toString())),t.limit&&(e=e.set("limit",t.limit.toString())),t.offset&&(e=e.set("offset",t.offset.toString()));try{return(yield _(this.http.get(`${this.apiUrl}/gallery`,{params:e}))).data}catch(n){return console.error("Failed to get product gallery:",n),this.getMockProductGallery(t)}})}getMockProductGallery(t){let n=[{id:"1",receiptItemId:"item1",imageUrl:"https://via.placeholder.com/300x300/FF6B6B/FFFFFF?text=Pocky",productName:"Pocky \uCD08\uCF5C\uB9BF",brand:"Glico",category:"\uACFC\uC790/\uC2A4\uB0B5",description:"\uC77C\uBCF8\uC758 \uB300\uD45C\uC801\uC778 \uACFC\uC790 \uBE0C\uB79C\uB4DC \uAE00\uB9AC\uCF54\uC758 \uD3EC\uD0A4 \uCD08\uCF5C\uB9BF\uB9DB",confidenceScore:.95,createdAt:new Date("2024-01-15"),updatedAt:new Date("2024-01-15")},{id:"2",receiptItemId:"item2",imageUrl:"https://via.placeholder.com/300x300/4ECDC4/FFFFFF?text=Kit+Kat",productName:"Kit Kat \uB9D0\uCC28\uB9DB",brand:"Nestle",category:"\uACFC\uC790/\uC2A4\uB0B5",description:"\uC77C\uBCF8 \uD55C\uC815 \uB9D0\uCC28\uB9DB \uD0B7\uCEA3",confidenceScore:.88,createdAt:new Date("2024-01-16"),updatedAt:new Date("2024-01-16")},{id:"3",receiptItemId:"item3",imageUrl:"https://via.placeholder.com/300x300/45B7D1/FFFFFF?text=Shiseido",productName:"Shiseido \uC120\uD06C\uB9BC",brand:"Shiseido",category:"\uBDF0\uD2F0/\uD654\uC7A5\uD488",description:"\uC2DC\uC138\uC774\uB3C4 \uC544\uB124\uC0AC \uD37C\uD399\uD2B8 UV \uC120\uD06C\uB9BC",confidenceScore:.92,createdAt:new Date("2024-01-17"),updatedAt:new Date("2024-01-17")},{id:"4",receiptItemId:"item4",imageUrl:"https://via.placeholder.com/300x300/96CEB4/FFFFFF?text=Ramune",productName:"\uB77C\uBB34\uB124 \uC0AC\uC774\uB2E4",brand:"Sangaria",category:"\uC74C\uB8CC",description:"\uC77C\uBCF8 \uC804\uD1B5 \uD0C4\uC0B0\uC74C\uB8CC \uB77C\uBB34\uB124",confidenceScore:.76,createdAt:new Date("2024-01-18"),updatedAt:new Date("2024-01-18")},{id:"5",receiptItemId:"item5",imageUrl:"https://via.placeholder.com/300x300/FFEAA7/000000?text=Calbee",productName:"Calbee \uAC10\uC790\uCE69",brand:"Calbee",category:"\uACFC\uC790/\uC2A4\uB0B5",description:"\uCE7C\uBE44 \uC624\uB9AC\uC9C0\uB110 \uAC10\uC790\uCE69",confidenceScore:.84,createdAt:new Date("2024-01-19"),updatedAt:new Date("2024-01-19")}];t.category&&(n=n.filter(C=>C.category===t.category)),t.brand&&(n=n.filter(C=>C.brand===t.brand)),t.minConfidence!==void 0&&(n=n.filter(C=>C.confidenceScore>=t.minConfidence));let l=t.offset||0,g=t.limit||50;return n.slice(l,l+g)}getProductById(t){return m(this,null,function*(){try{return(yield _(this.http.get(`${this.apiUrl}/images/${t}`))).data}catch(e){throw console.error("Failed to get product:",e),e}})}updateProduct(t,e){return m(this,null,function*(){try{return(yield _(this.http.put(`${this.apiUrl}/images/${t}`,e))).data}catch(n){throw console.error("Failed to update product:",n),n}})}deleteProduct(t){return m(this,null,function*(){try{yield _(this.http.delete(`${this.apiUrl}/images/${t}`))}catch(e){throw console.error("Failed to delete product:",e),e}})}findSimilarProducts(t,e,n,l=10){return m(this,null,function*(){let g=new B;t&&(g=g.set("productName",t)),e&&(g=g.set("brand",e)),n&&(g=g.set("category",n)),g=g.set("limit",l.toString());try{return(yield _(this.http.get(`${this.apiUrl}/similar`,{params:g}))).data}catch(C){return console.error("Failed to find similar products:",C),this.getMockProductGallery({}).filter(I=>(!e||I.brand===e)&&(!n||I.category===n)).slice(0,l)}})}getProductStatistics(){return m(this,null,function*(){try{return(yield _(this.http.get(`${this.apiUrl}/statistics`))).data}catch(t){throw console.error("Failed to get product statistics:",t),t}})}getProductsByReceiptItem(t){return m(this,null,function*(){let e=new B().set("receiptItemId",t);try{return(yield _(this.http.get(`${this.apiUrl}/gallery`,{params:e}))).data}catch(n){throw console.error("Failed to get products by receipt item:",n),n}})}healthCheck(){return m(this,null,function*(){try{return(yield _(this.http.get(`${this.apiUrl}/health`))).data}catch(t){throw console.error("Product service health check failed:",t),t}})}};r.\u0275fac=function(e){return new(e||r)(A(N))},r.\u0275prov=T({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();var Ot=(()=>{let r=class r{constructor(t){this.http=t,this.apiUrl=`${V.apiUrl}/api/products`}getPopularProducts(){return m(this,arguments,function*(t={}){let e=new B;t.category&&(e=e.set("category",t.category)),t.storeName&&(e=e.set("storeName",t.storeName)),t.limit&&(e=e.set("limit",t.limit.toString())),t.offset&&(e=e.set("offset",t.offset.toString())),t.minPurchaseCount&&(e=e.set("minPurchaseCount",t.minPurchaseCount.toString())),t.sortBy&&(e=e.set("sortBy",t.sortBy)),t.sortOrder&&(e=e.set("sortOrder",t.sortOrder));try{return(yield _(this.http.get(`${this.apiUrl}/popular`,{params:e}))).data.map(l=>v(M({},l),{lastUpdated:new Date(l.lastUpdated)}))}catch(n){return console.error("Failed to get popular products:",n),this.getMockPopularProducts(t)}})}getPopularProductById(t){return m(this,null,function*(){try{let e=yield _(this.http.get(`${this.apiUrl}/popular/${t}`));return v(M({},e.data),{lastUpdated:new Date(e.data.lastUpdated)})}catch(e){return console.error("Failed to get popular product by ID:",e),null}})}getPopularProductsByStore(t,e=10){return m(this,null,function*(){try{let n=yield _(this.http.get(`${this.apiUrl}/popular/store/${encodeURIComponent(t)}?limit=${e}`));return v(M({},n.data),{products:n.data.products.map(l=>v(M({},l),{lastUpdated:new Date(l.lastUpdated)}))})}catch(n){return console.error("Failed to get popular products by store:",n),this.getMockPopularProductsByStore(t,e)}})}getTrendingProducts(t=30,e=2){return m(this,null,function*(){let n=new B().set("periodDays",t.toString()).set("minPurchaseThreshold",e.toString());try{return(yield _(this.http.get(`${this.apiUrl}/trending`,{params:n}))).data}catch(l){return console.error("Failed to get trending products:",l),this.getMockTrendingProducts()}})}getRecommendations(t){return m(this,null,function*(){try{return(yield _(this.http.post(`${this.apiUrl}/recommendations`,t))).data.map(n=>v(M({},n),{product:v(M({},n.product),{lastUpdated:new Date(n.product.lastUpdated)}),similarProducts:n.similarProducts?.map(l=>v(M({},l),{lastUpdated:new Date(l.lastUpdated)}))}))}catch(e){return console.error("Failed to get recommendations:",e),this.getMockRecommendations(t)}})}getProductStatistics(){return m(this,null,function*(){try{return(yield _(this.http.get(`${this.apiUrl}/statistics`))).data.map(e=>v(M({},e),{topProducts:e.topProducts.map(n=>v(M({},n),{lastUpdated:new Date(n.lastUpdated)}))}))}catch(t){return console.error("Failed to get product statistics:",t),this.getMockProductStatistics()}})}getMockPopularProducts(t){let n=[{id:"1",productName:"Pocky \uCD08\uCF5C\uB9BF",category:"\uACFC\uC790/\uC2A4\uB0B5",purchaseCount:45,averagePriceJpy:150,averagePriceKrw:1500,lastUpdated:new Date("2024-01-20")},{id:"2",productName:"Kit Kat \uB9D0\uCC28\uB9DB",category:"\uACFC\uC790/\uC2A4\uB0B5",purchaseCount:38,averagePriceJpy:200,averagePriceKrw:2e3,lastUpdated:new Date("2024-01-19")},{id:"3",productName:"Shiseido \uC120\uD06C\uB9BC",category:"\uBDF0\uD2F0/\uD654\uC7A5\uD488",purchaseCount:32,averagePriceJpy:2500,averagePriceKrw:25e3,lastUpdated:new Date("2024-01-18")},{id:"4",productName:"\uB77C\uBB34\uB124 \uC0AC\uC774\uB2E4",category:"\uC74C\uB8CC",purchaseCount:28,averagePriceJpy:120,averagePriceKrw:1200,lastUpdated:new Date("2024-01-17")},{id:"5",productName:"Calbee \uAC10\uC790\uCE69",category:"\uACFC\uC790/\uC2A4\uB0B5",purchaseCount:25,averagePriceJpy:180,averagePriceKrw:1800,lastUpdated:new Date("2024-01-16")},{id:"6",productName:"\uD558\uC774\uCE04 \uB538\uAE30\uB9DB",category:"\uACFC\uC790/\uC2A4\uB0B5",purchaseCount:22,averagePriceJpy:130,averagePriceKrw:1300,lastUpdated:new Date("2024-01-15")},{id:"7",productName:"SK-II \uC5D0\uC13C\uC2A4",category:"\uBDF0\uD2F0/\uD654\uC7A5\uD488",purchaseCount:18,averagePriceJpy:15e3,averagePriceKrw:15e4,lastUpdated:new Date("2024-01-14")},{id:"8",productName:"\uC544\uC0AC\uD788 \uB9E5\uC8FC",category:"\uC74C\uB8CC",purchaseCount:35,averagePriceJpy:250,averagePriceKrw:2500,lastUpdated:new Date("2024-01-13")}];t.category&&(n=n.filter(C=>C.category===t.category)),t.minPurchaseCount&&(n=n.filter(C=>C.purchaseCount>=t.minPurchaseCount)),t.sortBy&&n.sort((C,U)=>{let I,k;switch(t.sortBy){case"purchaseCount":I=C.purchaseCount,k=U.purchaseCount;break;case"averagePrice":I=C.averagePriceJpy,k=U.averagePriceJpy;break;case"lastUpdated":I=C.lastUpdated.getTime(),k=U.lastUpdated.getTime();break;default:return 0}let R=I<k?-1:I>k?1:0;return t.sortOrder==="desc"?-R:R});let l=t.offset||0,g=t.limit||50;return n.slice(l,l+g)}getMockPopularProductsByStore(t,e){let n=this.getMockPopularProducts({});return{storeName:t,products:n.slice(0,e)}}getMockTrendingProducts(){return[{id:"1",productName:"Kit Kat \uB9D0\uCC28\uB9DB",category:"\uACFC\uC790/\uC2A4\uB0B5",currentPurchaseCount:38,previousPurchaseCount:25,trendPercentage:52,averagePriceJpy:200,averagePriceKrw:2e3,isRising:!0},{id:"2",productName:"\uD558\uC774\uCE04 \uB538\uAE30\uB9DB",category:"\uACFC\uC790/\uC2A4\uB0B5",currentPurchaseCount:22,previousPurchaseCount:15,trendPercentage:46.7,averagePriceJpy:130,averagePriceKrw:1300,isRising:!0},{id:"3",productName:"Shiseido \uC120\uD06C\uB9BC",category:"\uBDF0\uD2F0/\uD654\uC7A5\uD488",currentPurchaseCount:32,previousPurchaseCount:24,trendPercentage:33.3,averagePriceJpy:2500,averagePriceKrw:25e3,isRising:!0}]}getMockRecommendations(t){let e=this.getMockPopularProducts({});return e.slice(0,t.limit||5).map((n,l)=>({product:n,recommendationScore:85-l*5,reason:`\uC778\uAE30 \uC0C1\uD488 (${n.purchaseCount}\uD68C \uAD6C\uB9E4)`,similarProducts:e.slice(l+1,l+4)}))}getMockProductStatistics(){let t=this.getMockPopularProducts({});return[...new Set(t.map(n=>n.category).filter(Boolean))].map(n=>{let l=t.filter(g=>g.category===n);return{category:n,totalProducts:l.length,totalPurchases:l.reduce((g,C)=>g+C.purchaseCount,0),averagePrice:Math.round(l.reduce((g,C)=>g+C.averagePriceJpy,0)/l.length),topProducts:l.slice(0,3)}})}};r.\u0275fac=function(e){return new(e||r)(A(N))},r.\u0275prov=T({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();var Bt=["\uACFC\uC790/\uC2A4\uB0B5","\uC74C\uB8CC","\uC2DD\uD488","\uBDF0\uD2F0/\uD654\uC7A5\uD488","\uC758\uC57D\uD488","\uC0DD\uD65C\uC6A9\uD488","\uD328\uC158/\uC758\uB958","\uC804\uC790\uC81C\uD488","\uBB38\uAD6C/\uC7A1\uD654","\uAE30\uD0C0"],Ft=["Pocky","Kit Kat","Meiji","Glico","Calbee","Nissin","Shiseido","SK-II","Uniqlo","Muji","Nintendo","Sony","Panasonic","DHC","Rohto","Lion","Kao","P&G Japan"];function At(o,r){if(o&1){let i=x();c(0,"ion-button",15),S("click",function(){h(i);let e=p();return f(e.toggleEditMode())}),w(1,"ion-icon",16),d()}if(o&2){let i=p();s("disabled",i.isSaving),a(),s("name",i.isEditing?"eye":"create")}}function Nt(o,r){o&1&&w(0,"ion-spinner",19)}function Vt(o,r){o&1&&w(0,"ion-icon",20)}function Rt(o,r){if(o&1){let i=x();c(0,"ion-button",15),S("click",function(){h(i);let e=p();return f(e.saveChanges())}),P(1,Nt,1,0,"ion-spinner",17)(2,Vt,1,0,"ion-icon",18),d()}if(o&2){let i=p();s("disabled",i.isSaving),a(),s("ngIf",i.isSaving),a(),s("ngIf",!i.isSaving)}}function Kt(o,r){if(o&1){let i=x();c(0,"ion-button",21),S("click",function(){h(i);let e=p();return f(e.viewSimilarProducts())}),w(1,"ion-icon",22),d()}}function $t(o,r){if(o&1&&w(0,"ion-img",23),o&2){let i=p();s("src",i.getProductImageUrl())("alt",i.product.productName||"\uC0C1\uD488 \uC774\uBBF8\uC9C0")}}function jt(o,r){o&1&&(c(0,"div",24),w(1,"ion-icon",25),c(2,"p"),u(3,"\uC774\uBBF8\uC9C0 \uC5C6\uC74C"),d()())}function Jt(o,r){if(o&1&&(c(0,"ion-badge",26),u(1),d()),o&2){let i=p();s("color",i.getConfidenceColor(i.getProductConfidence())),a(),D(" \uC2E0\uB8B0\uB3C4: ",(i.getProductConfidence()*100).toFixed(0),"% ")}}function Wt(o,r){if(o&1&&(c(0,"ion-badge",27),u(1),d()),o&2){let i=p();a(),D(" ",i.getPopularProduct().purchaseCount,"\uD68C \uAD6C\uB9E4 ")}}function zt(o,r){if(o&1){let i=x();c(0,"ion-input",28),O("ngModelChange",function(e){h(i);let n=p();return E(n.editData.productName,e)||(n.editData.productName=e),f(e)}),d()}if(o&2){let i=p();b("ngModel",i.editData.productName)}}function Lt(o,r){if(o&1&&(c(0,"ion-label"),u(1),d()),o&2){let i=p();a(),D(" ",i.product.productName||"\uC54C \uC218 \uC5C6\uB294 \uC0C1\uD488"," ")}}function Gt(o,r){if(o&1&&(c(0,"ion-select-option",34),u(1),d()),o&2){let i=r.$implicit;s("value",i),a(),D(" ",i," ")}}function Ht(o,r){if(o&1){let i=x();c(0,"ion-select",31),O("ngModelChange",function(e){h(i);let n=p(2);return E(n.editData.brand,e)||(n.editData.brand=e),f(e)}),c(1,"ion-select-option",32),u(2,"\uC120\uD0DD \uC548\uD568"),d(),P(3,Gt,2,2,"ion-select-option",33),d()}if(o&2){let i=p(2);b("ngModel",i.editData.brand),a(3),s("ngForOf",i.availableBrands)}}function Qt(o,r){if(o&1){let i=x();c(0,"ion-input",35),O("ngModelChange",function(e){h(i);let n=p(2);return E(n.customBrand,e)||(n.customBrand=e),f(e)}),d()}if(o&2){let i=p(2);b("ngModel",i.customBrand)}}function Xt(o,r){if(o&1&&(c(0,"ion-label"),u(1),d()),o&2){let i=p(2);a(),D(" ",i.getProductBrand()," ")}}function Yt(o,r){if(o&1&&(c(0,"ion-item")(1,"ion-label",12),u(2,"\uBE0C\uB79C\uB4DC"),d(),P(3,Ht,4,2,"ion-select",29)(4,Qt,1,1,"ion-input",30)(5,Xt,2,1,"ion-label",14),d()),o&2){let i=p();a(3),s("ngIf",i.isEditing),a(),s("ngIf",i.isEditing&&i.editData.brand==="custom"),a(),s("ngIf",!i.isEditing)}}function Zt(o,r){if(o&1&&(c(0,"ion-select-option",34),u(1),d()),o&2){let i=r.$implicit;s("value",i),a(),D(" ",i," ")}}function qt(o,r){if(o&1){let i=x();c(0,"ion-select",37),O("ngModelChange",function(e){h(i);let n=p(2);return E(n.editData.category,e)||(n.editData.category=e),f(e)}),c(1,"ion-select-option",32),u(2,"\uC120\uD0DD \uC548\uD568"),d(),P(3,Zt,2,2,"ion-select-option",33),d()}if(o&2){let i=p(2);b("ngModel",i.editData.category),a(3),s("ngForOf",i.availableCategories)}}function te(o,r){if(o&1&&(c(0,"ion-label"),u(1),d()),o&2){let i=p(2);a(),D(" ",i.product.category," ")}}function ee(o,r){if(o&1&&(c(0,"ion-item")(1,"ion-label",12),u(2,"\uCE74\uD14C\uACE0\uB9AC"),d(),P(3,qt,4,2,"ion-select",36)(4,te,2,1,"ion-label",14),d()),o&2){let i=p();a(3),s("ngIf",i.isEditing),a(),s("ngIf",!i.isEditing)}}function ne(o,r){if(o&1&&(c(0,"ion-item")(1,"ion-label")(2,"h3"),u(3,"\uD3C9\uADE0 \uAC00\uACA9"),d(),c(4,"p"),u(5),d()()()),o&2){let i=p();a(5),y(i.formatPrice(i.getPopularProduct().averagePriceJpy,i.getPopularProduct().averagePriceKrw))}}function ie(o,r){if(o&1&&(c(0,"ion-item")(1,"ion-label")(2,"h3"),u(3,"\uAD6C\uB9E4 \uD69F\uC218"),d(),c(4,"p"),u(5),d()()()),o&2){let i=p();a(5),D("",i.getPopularProduct().purchaseCount,"\uD68C")}}function oe(o,r){if(o&1){let i=x();c(0,"ion-textarea",40),O("ngModelChange",function(e){h(i);let n=p(2);return E(n.editData.description,e)||(n.editData.description=e),f(e)}),d()}if(o&2){let i=p(2);b("ngModel",i.editData.description)}}function re(o,r){if(o&1&&(c(0,"ion-label",41),u(1),d()),o&2){let i=p(2);a(),D(" ",i.getProductDescription()," ")}}function ae(o,r){if(o&1&&(c(0,"ion-item")(1,"ion-label",12),u(2,"\uC124\uBA85"),d(),P(3,oe,1,1,"ion-textarea",38)(4,re,2,1,"ion-label",39),d()),o&2){let i=p();a(3),s("ngIf",i.isEditing),a(),s("ngIf",!i.isEditing)}}function ce(o,r){if(o&1){let i=x();c(0,"ion-item")(1,"ion-label",12),u(2),d(),c(3,"ion-range",42),O("ngModelChange",function(e){h(i);let n=p();return E(n.editData.confidenceScore,e)||(n.editData.confidenceScore=e),f(e)}),c(4,"ion-label",0),u(5,"0%"),d(),c(6,"ion-label",3),u(7,"100%"),d()()()}if(o&2){let i=p();a(2),D(" \uC2E0\uB8B0\uB3C4: ",(i.editData.confidenceScore*100).toFixed(0),"% "),a(),b("ngModel",i.editData.confidenceScore)}}function de(o,r){if(o&1){let i=x();c(0,"div",45),S("click",function(){let e=h(i).$implicit,n=p(2);return f(n.viewRecommendation(e))}),c(1,"div",46)(2,"h4"),u(3),d(),c(4,"p"),u(5),d(),c(6,"p",47),u(7),d()(),c(8,"ion-badge",48),u(9),d()()}if(o&2){let i=r.$implicit,t=p(2);a(3),y(i.product.productName),a(2),y(i.reason),a(2),y(t.formatPrice(i.product.averagePriceJpy,i.product.averagePriceKrw)),a(2),y(i.recommendationScore.toFixed(0))}}function se(o,r){if(o&1&&(c(0,"ion-card")(1,"ion-card-content")(2,"h3"),u(3,"\uCD94\uCC9C \uC0C1\uD488"),d(),c(4,"div",43),P(5,de,10,4,"div",44),d()()()),o&2){let i=p();a(5),s("ngForOf",i.recommendations)}}function le(o,r){if(o&1){let i=x();c(0,"div",51),S("click",function(){let e=h(i).$implicit,n=p(2);return f(n.viewSimilarProduct(e))}),w(1,"ion-img",23),c(2,"p"),u(3),d()()}if(o&2){let i=r.$implicit;a(),s("src",i.imageUrl)("alt",i.productName),a(2),y(i.productName)}}function ue(o,r){if(o&1&&(c(0,"ion-card")(1,"ion-card-content")(2,"h3"),u(3,"\uC720\uC0AC\uD55C \uC0C1\uD488"),d(),c(4,"div",49),P(5,le,4,3,"div",50),d()()()),o&2){let i=p();a(5),s("ngForOf",i.similarProducts)}}function pe(o,r){if(o&1&&(c(0,"ion-item")(1,"ion-label")(2,"h4"),u(3),d(),c(4,"p"),u(5),d()()()),o&2){let i=p();a(3),y(i.isPopularProduct()?"\uB9C8\uC9C0\uB9C9 \uC5C5\uB370\uC774\uD2B8":"\uC0DD\uC131\uC77C"),a(2),y(i.formatDate(i.getProductCreatedAt()))}}function me(o,r){if(o&1&&(c(0,"ion-item")(1,"ion-label")(2,"h4"),u(3,"\uC218\uC815\uC77C"),d(),c(4,"p"),u(5),d()()()),o&2){let i=p();a(5),y(i.formatDate(i.getProductUpdatedAt()))}}var Fe=(()=>{let r=class r{constructor(t,e,n,l,g){this.modalController=t,this.productService=e,this.popularProductService=n,this.alertController=l,this.toastController=g,this.showRecommendations=!1,this.isEditing=!1,this.isSaving=!1,this.editData={},this.customBrand="",this.similarProducts=[],this.recommendations=[],this.availableCategories=Bt,this.availableBrands=[...Ft,"custom"],_t({close:ht,save:vt,create:ft,star:It,starOutline:St,checkmark:Pt,refresh:Mt,eye:xt,eyeOff:yt,search:wt,imageOutline:Dt})}ngOnInit(){this.initializeEditData(),this.loadSimilarProducts(),this.showRecommendations&&this.isPopularProduct()&&this.loadRecommendations()}initializeEditData(){if(this.isPopularProduct()){let t=this.getPopularProduct();this.editData={productName:t.productName,category:t.category}}else{let t=this.getProductImage();this.editData={productName:t.productName,brand:t.brand,category:t.category,description:t.description,confidenceScore:t.confidenceScore}}}loadSimilarProducts(){return m(this,null,function*(){try{if(!this.isPopularProduct()){let t=this.getProductImage();this.similarProducts=yield this.productService.findSimilarProducts(void 0,t.brand,t.category,5),this.similarProducts=this.similarProducts.filter(e=>e.id!==this.product.id)}}catch(t){console.error("Failed to load similar products:",t)}})}toggleEditMode(){this.isEditing=!this.isEditing,this.isEditing||this.initializeEditData()}saveChanges(){return m(this,null,function*(){if(!this.isSaving){this.isSaving=!0;try{this.editData.brand==="custom"&&this.customBrand.trim()&&(this.editData.brand=this.customBrand.trim());let t=yield this.productService.updateProduct(this.product.id,this.editData);Object.assign(this.product,t),this.isEditing=!1,yield(yield this.toastController.create({message:"\uC0C1\uD488 \uC815\uBCF4\uAC00 \uC5C5\uB370\uC774\uD2B8\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",duration:2e3,color:"success"})).present()}catch(t){console.error("Failed to update product:",t),yield(yield this.alertController.create({header:"\uC624\uB958",message:"\uC0C1\uD488 \uC815\uBCF4 \uC5C5\uB370\uC774\uD2B8\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.",buttons:["\uD655\uC778"]})).present()}finally{this.isSaving=!1}}})}viewSimilarProduct(t){return m(this,null,function*(){yield(yield this.modalController.create({component:r,componentProps:{product:t}})).present()})}getConfidenceColor(t){return t>=.8?"success":t>=.6?"warning":"danger"}formatDate(t){return t?new Date(t).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"\uC54C \uC218 \uC5C6\uC74C"}isPopularProduct(){return"purchaseCount"in this.product}getPopularProduct(){return this.product}getProductImage(){return this.product}getProductImageUrl(){if(!this.isPopularProduct())return this.getProductImage().imageUrl}getProductConfidence(){if(!this.isPopularProduct())return this.getProductImage().confidenceScore}getProductCreatedAt(){return this.isPopularProduct()?this.getPopularProduct().lastUpdated:this.getProductImage().createdAt}getProductUpdatedAt(){if(!this.isPopularProduct())return this.getProductImage().updatedAt}getProductBrand(){if(!this.isPopularProduct())return this.getProductImage().brand}getProductDescription(){if(!this.isPopularProduct())return this.getProductImage().description}loadRecommendations(){return m(this,null,function*(){if(this.isPopularProduct())try{let t=this.getPopularProduct();this.recommendations=yield this.popularProductService.getRecommendations({category:t.category,limit:5,excludeProducts:[t.productName]})}catch(t){console.error("Failed to load recommendations:",t)}})}viewSimilarProducts(){return m(this,null,function*(){if(this.isPopularProduct())try{let t=this.getPopularProduct(),e=yield this.popularProductService.getRecommendations({category:t.category,limit:10,excludeProducts:[t.productName]});yield(yield this.alertController.create({header:`${t.productName}\uC640 \uC720\uC0AC\uD55C \uC0C1\uD488`,message:e.map(l=>`\u2022 ${l.product.productName} (${l.product.purchaseCount}\uD68C \uAD6C\uB9E4)`).join(`
`),buttons:["\uD655\uC778"]})).present()}catch(t){console.error("Failed to load similar products:",t)}})}viewRecommendation(t){return m(this,null,function*(){yield(yield this.modalController.create({component:r,componentProps:{product:t.product,showRecommendations:!0}})).present()})}formatPrice(t,e){return e?`\xA5${t.toLocaleString()} (\u20A9${e.toLocaleString()})`:`\xA5${t.toLocaleString()}`}dismiss(t=!1){this.modalController.dismiss({updated:t})}};r.\u0275fac=function(e){return new(e||r)(F(dt),F(Et),F(Ot),F(st),F(lt))},r.\u0275cmp=K({type:r,selectors:[["app-product-detail-modal"]],inputs:{product:"product",showRecommendations:"showRecommendations"},decls:47,vars:21,consts:[["slot","start"],[3,"click"],["name","close"],["slot","end"],[3,"disabled","click",4,"ngIf"],["fill","clear",3,"click",4,"ngIf"],[1,"image-container"],[3,"src","alt",4,"ngIf"],["class","placeholder-image",4,"ngIf"],["class","confidence-badge",3,"color",4,"ngIf"],["class","popularity-badge","color","primary",4,"ngIf"],[1,"content-container"],["position","stacked"],["placeholder","\uC0C1\uD488\uBA85\uC744 \uC785\uB825\uD558\uC138\uC694",3,"ngModel","ngModelChange",4,"ngIf"],[4,"ngIf"],[3,"click","disabled"],[3,"name"],["name","crescent",4,"ngIf"],["name","save",4,"ngIf"],["name","crescent"],["name","save"],["fill","clear",3,"click"],["name","search"],[3,"src","alt"],[1,"placeholder-image"],["name","image-outline","size","large"],[1,"confidence-badge",3,"color"],["color","primary",1,"popularity-badge"],["placeholder","\uC0C1\uD488\uBA85\uC744 \uC785\uB825\uD558\uC138\uC694",3,"ngModelChange","ngModel"],["placeholder","\uBE0C\uB79C\uB4DC\uB97C \uC120\uD0DD\uD558\uC138\uC694","interface","popover",3,"ngModel","ngModelChange",4,"ngIf"],["placeholder","\uC9C1\uC811 \uC785\uB825",3,"ngModel","ngModelChange",4,"ngIf"],["placeholder","\uBE0C\uB79C\uB4DC\uB97C \uC120\uD0DD\uD558\uC138\uC694","interface","popover",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["placeholder","\uC9C1\uC811 \uC785\uB825",3,"ngModelChange","ngModel"],["placeholder","\uCE74\uD14C\uACE0\uB9AC\uB97C \uC120\uD0DD\uD558\uC138\uC694","interface","popover",3,"ngModel","ngModelChange",4,"ngIf"],["placeholder","\uCE74\uD14C\uACE0\uB9AC\uB97C \uC120\uD0DD\uD558\uC138\uC694","interface","popover",3,"ngModelChange","ngModel"],["placeholder","\uC0C1\uD488 \uC124\uBA85\uC744 \uC785\uB825\uD558\uC138\uC694","rows","3",3,"ngModel","ngModelChange",4,"ngIf"],["class","description-text",4,"ngIf"],["placeholder","\uC0C1\uD488 \uC124\uBA85\uC744 \uC785\uB825\uD558\uC138\uC694","rows","3",3,"ngModelChange","ngModel"],[1,"description-text"],["min","0","max","1","step","0.1","color","primary",3,"ngModelChange","ngModel"],[1,"recommendations"],["class","recommendation-item",3,"click",4,"ngFor","ngForOf"],[1,"recommendation-item",3,"click"],[1,"recommendation-info"],[1,"price"],["color","success"],[1,"similar-products"],["class","similar-product",3,"click",4,"ngFor","ngForOf"],[1,"similar-product",3,"click"]],template:function(e,n){e&1&&(c(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),u(3),d(),c(4,"ion-buttons",0)(5,"ion-button",1),S("click",function(){return n.dismiss()}),w(6,"ion-icon",2),d()(),c(7,"ion-buttons",3),P(8,At,2,2,"ion-button",4)(9,Rt,3,3,"ion-button",4)(10,Kt,2,0,"ion-button",5),d()()(),c(11,"ion-content")(12,"div",6),P(13,$t,1,2,"ion-img",7)(14,jt,4,0,"div",8)(15,Jt,2,2,"ion-badge",9)(16,Wt,2,1,"ion-badge",10),d(),c(17,"div",11)(18,"ion-card")(19,"ion-card-content")(20,"ion-list")(21,"ion-item")(22,"ion-label",12),u(23,"\uC0C1\uD488\uBA85"),d(),P(24,zt,1,1,"ion-input",13)(25,Lt,2,1,"ion-label",14),d(),P(26,Yt,6,3,"ion-item",14)(27,ee,5,2,"ion-item",14)(28,ne,6,1,"ion-item",14)(29,ie,6,1,"ion-item",14)(30,ae,5,2,"ion-item",14)(31,ce,8,2,"ion-item",14),d()()(),P(32,se,6,1,"ion-card",14)(33,ue,6,1,"ion-card",14),c(34,"ion-card")(35,"ion-card-content")(36,"h3"),u(37,"\uBA54\uD0C0\uB370\uC774\uD130"),d(),c(38,"ion-list"),P(39,pe,6,2,"ion-item",14)(40,me,6,1,"ion-item",14),c(41,"ion-item")(42,"ion-label")(43,"h4"),u(44,"\uC0C1\uD488 ID"),d(),c(45,"p"),u(46),d()()()()()()()()),e&2&&(a(3),y(n.isPopularProduct()?"\uC778\uAE30 \uC0C1\uD488 \uC0C1\uC138":"\uC0C1\uD488 \uC0C1\uC138"),a(5),s("ngIf",!n.isPopularProduct()),a(),s("ngIf",n.isEditing),a(),s("ngIf",n.showRecommendations&&n.isPopularProduct()),a(3),s("ngIf",n.getProductImageUrl()),a(),s("ngIf",!n.getProductImageUrl()),a(),s("ngIf",n.getProductConfidence()!==void 0),a(),s("ngIf",n.isPopularProduct()),a(8),s("ngIf",n.isEditing),a(),s("ngIf",!n.isEditing),a(),s("ngIf",n.getProductBrand()||n.isEditing),a(),s("ngIf",n.product.category||n.isEditing),a(),s("ngIf",n.isPopularProduct()),a(),s("ngIf",n.isPopularProduct()),a(),s("ngIf",n.getProductDescription()||n.isEditing),a(),s("ngIf",n.isEditing&&n.getProductConfidence()!==void 0),a(),s("ngIf",n.recommendations.length>0),a(),s("ngIf",n.similarProducts.length>0),a(6),s("ngIf",n.getProductCreatedAt()),a(),s("ngIf",n.getProductUpdatedAt()),a(6),y(n.product.id))},dependencies:[J,$,j,L,W,z,q,ct,at,Z,Q,H,ut,et,nt,pt,Ct,gt,ot,tt,G,X,Y,it,mt,rt],styles:[".image-container[_ngcontent-%COMP%]{position:relative;height:250px;overflow:hidden}.image-container[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.image-container[_ngcontent-%COMP%]   .placeholder-image[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;background:var(--ion-color-light);color:var(--ion-color-medium)}.image-container[_ngcontent-%COMP%]   .placeholder-image[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-bottom:8px}.image-container[_ngcontent-%COMP%]   .placeholder-image[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}.image-container[_ngcontent-%COMP%]   .confidence-badge[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px;font-size:12px;padding:4px 8px}.image-container[_ngcontent-%COMP%]   .popularity-badge[_ngcontent-%COMP%]{position:absolute;top:16px;left:16px;font-size:12px;padding:4px 8px}.content-container[_ngcontent-%COMP%]{padding:16px}.description-text[_ngcontent-%COMP%]{white-space:pre-wrap;word-break:break-word}.recommendations[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.recommendations[_ngcontent-%COMP%]   .recommendation-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px;background:var(--ion-color-light);border-radius:8px;cursor:pointer}.recommendations[_ngcontent-%COMP%]   .recommendation-item[_ngcontent-%COMP%]:hover{background:var(--ion-color-step-100)}.recommendations[_ngcontent-%COMP%]   .recommendation-item[_ngcontent-%COMP%]   .recommendation-info[_ngcontent-%COMP%]{flex:1}.recommendations[_ngcontent-%COMP%]   .recommendation-item[_ngcontent-%COMP%]   .recommendation-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-size:16px;font-weight:600;color:var(--ion-color-dark)}.recommendations[_ngcontent-%COMP%]   .recommendation-item[_ngcontent-%COMP%]   .recommendation-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 2px;font-size:14px;color:var(--ion-color-medium)}.recommendations[_ngcontent-%COMP%]   .recommendation-item[_ngcontent-%COMP%]   .recommendation-info[_ngcontent-%COMP%]   p.price[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:500}.recommendations[_ngcontent-%COMP%]   .recommendation-item[_ngcontent-%COMP%]   ion-badge[_ngcontent-%COMP%]{margin-left:12px}.similar-products[_ngcontent-%COMP%]{display:flex;gap:12px;overflow-x:auto;padding:8px 0}.similar-products[_ngcontent-%COMP%]   .similar-product[_ngcontent-%COMP%]{flex-shrink:0;width:80px;text-align:center;cursor:pointer}.similar-products[_ngcontent-%COMP%]   .similar-product[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:80px;height:80px;object-fit:cover;border-radius:8px;margin-bottom:4px}.similar-products[_ngcontent-%COMP%]   .similar-product[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px;margin:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}h3[_ngcontent-%COMP%]{margin:0 0 16px;color:var(--ion-color-dark);font-size:18px;font-weight:600}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0;--inner-padding-end: 0}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin:8px 0}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 4px;font-size:16px;font-weight:600;color:var(--ion-color-dark)}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 4px;font-size:14px;font-weight:600;color:var(--ion-color-dark)}ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;color:var(--ion-color-medium)}"]});let o=r;return o})();export{Bt as a,Ft as b,Et as c,Ot as d,Fe as e};
