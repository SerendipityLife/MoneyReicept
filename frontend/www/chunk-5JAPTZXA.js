import{Ea as m,a as C,b as $,g as o,p as h,r as b,t as f}from"./chunk-TEVF6OOM.js";import{a as u,b as j}from"./chunk-JHI3MBHO.js";var T=(()=>{let r=class r{constructor(t){this.http=t,this.apiUrl="http://localhost:3000/api/translate",this.translationCacheSubject=new $(new Map),this.translationCache$=this.translationCacheSubject.asObservable()}translateText(t,e="ja",n="ko"){let a=`${t}_${e}_${n}`,i=this.translationCacheSubject.value;if(i.has(a)){let s=i.get(a);return new C(c=>{c.next(j(u({},s),{cached:!0})),c.complete()})}return this.http.post(`${this.apiUrl}`,{text:t,sourceLanguage:e,targetLanguage:n}).pipe(o(s=>s.data),h(s=>{let c=new Map(i);c.set(a,s),this.translationCacheSubject.next(c)}))}batchTranslate(t,e="ja",n="ko"){return this.http.post(`${this.apiUrl}/batch`,{texts:t,sourceLanguage:e,targetLanguage:n}).pipe(o(a=>a.data),h(a=>{let i=this.translationCacheSubject.value,s=new Map(i);a.translations.forEach(c=>{let p=`${c.originalText}_${e}_${n}`;s.set(p,c)}),this.translationCacheSubject.next(s)}))}submitTranslationFeedback(t){return this.http.put(`${this.apiUrl}/correction`,t).pipe(h(()=>{let e=this.translationCacheSubject.value,n=`${t.originalText}_${t.sourceLanguage}_${t.targetLanguage}`;if(e.has(n)){let a=new Map(e),i=e.get(n);a.set(n,j(u({},i),{translatedText:t.correctedTranslation})),this.translationCacheSubject.next(a)}}))}getTranslationStats(){return this.http.get(`${this.apiUrl}/stats`).pipe(o(t=>t.data))}clearCache(t){let e={};return t&&(e.olderThanDays=t.toString()),this.http.delete(`${this.apiUrl}/cache`,{params:e}).pipe(h(()=>{this.translationCacheSubject.next(new Map)}))}getCachedTranslation(t,e="ja",n="ko"){let a=`${t}_${e}_${n}`;return this.translationCacheSubject.value.get(a)||null}needsTranslation(t,e="ja",n="ko"){return!t||t.trim()===""||e===n?!1:e==="ja"?/[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]/.test(t):!0}getCacheSize(){return this.translationCacheSubject.value.size}translateToMultipleLanguages(t,e="ja",n=["ko","en","zh"]){return this.http.post(`${this.apiUrl}/multi`,{text:t,sourceLanguage:e,targetLanguages:n}).pipe(o(a=>a.data),h(a=>{let i=this.translationCacheSubject.value,s=new Map(i);Object.keys(a).forEach(c=>{let p=`${t}_${e}_${c}`;s.set(p,a[c])}),this.translationCacheSubject.next(s)}))}};r.\u0275fac=function(e){return new(e||r)(f(m))},r.\u0275prov=b({token:r,factory:r.\u0275fac,providedIn:"root"});let l=r;return l})();export{T as a};
