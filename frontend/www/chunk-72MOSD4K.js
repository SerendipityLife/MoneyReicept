import{a as Se}from"./chunk-5JAPTZXA.js";import{a as be}from"./chunk-XPOQZT2W.js";import{a as ve}from"./chunk-ILIUFNZN.js";import"./chunk-WF62HMP4.js";import"./chunk-JHTPU5XN.js";import{Aa as V,Ba as j,Bb as ee,Cb as te,Db as ie,E as r,F as S,Gb as ne,H as R,Ha as z,Ja as J,Kb as ae,L as d,Lb as oe,Mb as re,P as l,Pa as F,Q as o,Qa as W,Qb as se,R as a,S as g,Tb as ce,Ua as K,W as x,X as f,Xb as le,Y as p,Yb as pe,_b as ue,ac as de,bc as ge,cc as _e,dc as me,fa as u,fc as Ce,ga as b,gc as he,ha as v,hc as xe,ka as y,la as T,ma as E,nc as fe,ob as N,pa as P,pb as H,qb as $,ra as I,rb as q,sa as B,sb as G,tb as U,va as O,vb as Q,w as _,wa as k,wb as X,x as m,xb as Y,ya as A,yb as Z,za as L}from"./chunk-TEVF6OOM.js";import"./chunk-5HJQGQPL.js";import"./chunk-7KGURMOZ.js";import"./chunk-7NBBWGH4.js";import"./chunk-MYTP3L75.js";import"./chunk-HDBTADGC.js";import"./chunk-YSN7XVTD.js";import"./chunk-R5HL6L5F.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-2YSZFPCQ.js";import"./chunk-57YRIO75.js";import"./chunk-F5TKO3NK.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{a as w,b as M,e as h}from"./chunk-JHI3MBHO.js";function Ie(t,c){if(t&1){let e=x();o(0,"ion-button",2),f("click",function(){_(e);let n=p();return m(n.presentActionSheet())}),g(1,"ion-icon",12),a()}}function De(t,c){if(t&1){let e=x();o(0,"ion-button",13),f("click",function(){_(e);let n=p();return m(n.saveChanges())}),g(1,"ion-icon",14),a()}}function Me(t,c){if(t&1){let e=x();o(0,"ion-button",15),f("click",function(){_(e);let n=p();return m(n.toggleEdit())}),g(1,"ion-icon",16),a()}}function Be(t,c){t&1&&(o(0,"div",17),g(1,"ion-spinner",18),o(2,"p"),u(3,"\uC601\uC218\uC99D\uC744 \uBD88\uB7EC\uC624\uB294 \uC911..."),a()())}function Re(t,c){if(t&1&&(o(0,"p"),u(1),a()),t&2){let e=p(2);r(),b(e.receipt.storeName||"\uC54C \uC218 \uC5C6\uC74C")}}function Oe(t,c){if(t&1){let e=x();o(0,"ion-input",33),E("ngModelChange",function(n){_(e);let s=p(2);return T(s.editableReceipt.storeName,n)||(s.editableReceipt.storeName=n),m(n)}),a()}if(t&2){let e=p(2);y("ngModel",e.editableReceipt.storeName)}}function ke(t,c){if(t&1&&(o(0,"p"),u(1),a()),t&2){let e=p(2);r(),b(e.receipt.storeLocation||"\uC54C \uC218 \uC5C6\uC74C")}}function Ae(t,c){if(t&1){let e=x();o(0,"ion-input",34),E("ngModelChange",function(n){_(e);let s=p(2);return T(s.editableReceipt.storeLocation,n)||(s.editableReceipt.storeLocation=n),m(n)}),a()}if(t&2){let e=p(2);y("ngModel",e.editableReceipt.storeLocation)}}function Le(t,c){if(t&1&&(o(0,"p"),u(1),P(2,"date"),a()),t&2){let e=p(2);r(),b(I(2,1,e.receipt.purchaseDate,"yyyy\uB144 MM\uC6D4 dd\uC77C HH:mm"))}}function Ve(t,c){if(t&1){let e=x();o(0,"ion-datetime",35),E("ngModelChange",function(n){_(e);let s=p(2);return T(s.editableReceipt.purchaseDate,n)||(s.editableReceipt.purchaseDate=n),m(n)}),a()}if(t&2){let e=p(2);y("ngModel",e.editableReceipt.purchaseDate)}}function je(t,c){if(t&1&&(o(0,"p",36),u(1),P(2,"number"),a()),t&2){let e=p(2);r(),v(" \xA5",I(2,1,e.receipt.totalAmountJpy,"1.0-0")," ")}}function ze(t,c){if(t&1){let e=x();o(0,"ion-input",37),E("ngModelChange",function(n){_(e);let s=p(2);return T(s.editableReceipt.totalAmountJpy,n)||(s.editableReceipt.totalAmountJpy=n),m(n)}),a()}if(t&2){let e=p(2);y("ngModel",e.editableReceipt.totalAmountJpy)}}function Je(t,c){if(t&1&&(o(0,"p",38),u(1),P(2,"currency"),a()),t&2){let e=p(2);r(),v(" ",B(2,1,e.receipt.totalAmountKrw,"KRW","symbol","1.0-0")," ")}}function Fe(t,c){if(t&1){let e=x();o(0,"ion-input",37),E("ngModelChange",function(n){_(e);let s=p(2);return T(s.editableReceipt.totalAmountKrw,n)||(s.editableReceipt.totalAmountKrw=n),m(n)}),a()}if(t&2){let e=p(2);y("ngModel",e.editableReceipt.totalAmountKrw)}}function We(t,c){if(t&1&&(o(0,"ion-row")(1,"ion-col",39)(2,"div",40)(3,"ion-note"),u(4),P(5,"number"),a()()()()),t&2){let e=p(2);r(4),v(" \uD658\uC728: 1\uC5D4 = ",I(5,1,e.receipt.totalAmountKrw/e.receipt.totalAmountJpy,"1.2-2"),"\uC6D0 ")}}function Ke(t,c){t&1&&(o(0,"span"),u(1,"\uC804\uCCB4 \uBC88\uC5ED"),a())}function Ne(t,c){t&1&&(o(0,"span"),u(1,"\uBC88\uC5ED \uC911..."),a())}function He(t,c){if(t&1){let e=x();o(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),u(3,"\uBC88\uC5ED \uC124\uC815"),a()(),o(4,"ion-card-content")(5,"ion-grid")(6,"ion-row")(7,"ion-col",28)(8,"ion-item")(9,"ion-label"),u(10,"\uC790\uB3D9 \uBC88\uC5ED"),a(),o(11,"ion-toggle",41),E("ngModelChange",function(n){_(e);let s=p(2);return T(s.translationSettings.autoTranslateEnabled,n)||(s.translationSettings.autoTranslateEnabled=n),m(n)}),f("ionChange",function(){_(e);let n=p(2);return m(n.toggleAutoTranslate())}),a()()(),o(12,"ion-col",28)(13,"ion-button",42),f("click",function(){_(e);let n=p(2);return m(n.translateAllItems())}),g(14,"ion-icon",43),d(15,Ke,2,0,"span",24)(16,Ne,2,0,"span",24),a()()(),o(17,"ion-row")(18,"ion-col",39)(19,"ion-button",44),f("click",function(){_(e);let n=p(2);return m(n.presentTranslationSettings())}),g(20,"ion-icon",45),u(21," \uBC88\uC5ED \uC124\uC815 "),a()()()()()()}if(t&2){let e=p(2);r(11),y("ngModel",e.translationSettings.autoTranslateEnabled),r(2),l("disabled",e.isTranslating),r(2),l("ngIf",!e.isTranslating),r(),l("ngIf",e.isTranslating)}}function $e(t,c){if(t&1&&(o(0,"h3",61),u(1),o(2,"ion-chip",62),g(3,"ion-icon",63),a()()),t&2){let e=p().$implicit,i=p(3);r(),v(" ",i.getTranslatedText(e.nameJp||e.name)," ")}}function qe(t,c){if(t&1&&(o(0,"h3",64),u(1),a()),t&2){let e=p().$implicit;r(),v(" ",e.nameKr," ")}}function Ge(t,c){if(t&1&&(o(0,"h3",65),u(1),a()),t&2){let e=p().$implicit;r(),v(" ",e.name," ")}}function Ue(t,c){if(t&1){let e=x();o(0,"ion-button",67),f("click",function(){_(e);let n=p(2).$implicit,s=p(3);return m(s.translateSingleItem(n.nameJp))}),g(1,"ion-icon",63),a()}}function Qe(t,c){if(t&1&&(o(0,"p",66),u(1),d(2,Ue,2,0,"ion-button",60),a()),t&2){let e=p().$implicit,i=p(3);r(),v(" ",e.nameJp," "),r(),l("ngIf",!i.hasTranslation(e.nameJp))}}function Xe(t,c){if(t&1&&(o(0,"p",68),u(1),a()),t&2){let e=p().$implicit;r(),v("\uC0C1\uD488\uCF54\uB4DC: ",e.productCode)}}function Ye(t,c){if(t&1&&(o(0,"ion-chip",69),u(1),a()),t&2){let e=p().$implicit;r(),v(" ",e.category," ")}}function Ze(t,c){if(t&1){let e=x();o(0,"ion-button",67),f("click",function(){_(e);let n=p().$implicit,s=p(3);return m(s.presentTranslationFeedback(n.nameJp||n.name))}),g(1,"ion-icon",70),a()}}function et(t,c){if(t&1){let e=x();o(0,"ion-button",67),f("click",function(){_(e);let n=p().$implicit,s=p(3);return m(s.editTranslation(n.nameJp||n.name))}),g(1,"ion-icon",71),a()}}function tt(t,c){if(t&1&&(o(0,"ion-item")(1,"ion-label")(2,"div",48),d(3,$e,4,1,"h3",49)(4,qe,2,1,"h3",50)(5,Ge,2,1,"h3",51)(6,Qe,3,2,"p",52),a(),o(7,"p"),u(8),a(),o(9,"div",53)(10,"span",54),u(11),P(12,"number"),a(),o(13,"span",55),u(14,"|"),a(),o(15,"span",56),u(16),P(17,"currency"),a()(),d(18,Xe,2,1,"p",57),a(),o(19,"div",58),d(20,Ye,2,1,"ion-chip",59)(21,Ze,2,0,"ion-button",60)(22,et,2,0,"ion-button",60),a()()),t&2){let e=c.$implicit,i=p(3);r(3),l("ngIf",i.hasTranslation(e.nameJp||e.name)),r(),l("ngIf",!i.hasTranslation(e.nameJp||e.name)&&e.nameKr),r(),l("ngIf",!i.hasTranslation(e.nameJp||e.name)&&!e.nameKr),r(),l("ngIf",e.nameJp),r(2),v("\uC218\uB7C9: ",e.quantity,"\uAC1C"),r(3),v("\xA5",I(12,11,e.priceJpy,"1.0-0")),r(5),b(B(17,14,e.priceKrw,"KRW","symbol","1.0-0")),r(2),l("ngIf",e.productCode),r(2),l("ngIf",e.category),r(),l("ngIf",i.hasTranslation(e.nameJp||e.name)),r(),l("ngIf",i.hasTranslation(e.nameJp||e.name))}}function it(t,c){if(t&1&&(o(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),u(3," \uAD6C\uB9E4 \uC0C1\uD488 \uBAA9\uB85D "),o(4,"ion-badge",46),u(5),a()()(),o(6,"ion-card-content")(7,"ion-list"),d(8,tt,23,19,"ion-item",47),a()()()),t&2){let e=p(2);r(5),b(e.receipt.items.length),r(3),l("ngForOf",e.receipt.items)}}function nt(t,c){t&1&&(o(0,"ion-card")(1,"ion-card-content")(2,"div",72),g(3,"ion-icon",73),o(4,"h3"),u(5,"\uC0C1\uD488 \uC815\uBCF4 \uC5C6\uC74C"),a(),o(6,"p"),u(7,"\uC774 \uC601\uC218\uC99D\uC5D0\uB294 \uC0C1\uD488 \uC815\uBCF4\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4."),a()()()())}function at(t,c){t&1&&g(0,"ion-icon",79)}function ot(t,c){t&1&&g(0,"ion-icon",80)}function rt(t,c){t&1&&g(0,"ion-icon",81)}function st(t,c){t&1&&(o(0,"span"),u(1," \uC601\uC218\uC99D\uC774 \uCC98\uB9AC \uB300\uAE30 \uC911\uC785\uB2C8\uB2E4. \uC7A0\uC2DC\uB9CC \uAE30\uB2E4\uB824\uC8FC\uC138\uC694. "),a())}function ct(t,c){t&1&&(o(0,"span"),u(1," \uC601\uC218\uC99D\uC744 \uBD84\uC11D\uD558\uACE0 \uC788\uC2B5\uB2C8\uB2E4. \uACE7 \uC644\uB8CC\uB429\uB2C8\uB2E4. "),a())}function lt(t,c){t&1&&(o(0,"span"),u(1," \uC601\uC218\uC99D \uCC98\uB9AC\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4. \uC218\uB3D9\uC73C\uB85C \uC815\uBCF4\uB97C \uC785\uB825\uD574\uC8FC\uC138\uC694. "),a())}function pt(t,c){if(t&1&&(o(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),u(3,"\uCC98\uB9AC \uC0C1\uD0DC"),a()(),o(4,"ion-card-content")(5,"div",74)(6,"ion-chip",23),d(7,at,1,0,"ion-icon",75)(8,ot,1,0,"ion-icon",76)(9,rt,1,0,"ion-icon",77),o(10,"ion-label"),u(11),a()(),o(12,"p",78),d(13,st,2,0,"span",24)(14,ct,2,0,"span",24)(15,lt,2,0,"span",24),a()()()()),t&2){let e=p(2);r(6),l("color",e.getStatusColor(e.receipt.processingStatus)),r(),l("ngIf",e.receipt.processingStatus==="pending"),r(),l("ngIf",e.receipt.processingStatus==="processing"),r(),l("ngIf",e.receipt.processingStatus==="failed"),r(2),b(e.getStatusText(e.receipt.processingStatus)),r(2),l("ngIf",e.receipt.processingStatus==="pending"),r(),l("ngIf",e.receipt.processingStatus==="processing"),r(),l("ngIf",e.receipt.processingStatus==="failed")}}function ut(t,c){if(t&1&&(o(0,"div",19)(1,"ion-card",20),g(2,"ion-img",21),o(3,"div",22)(4,"ion-chip",23)(5,"ion-label"),u(6),a()()()(),o(7,"ion-card")(8,"ion-card-header")(9,"ion-card-title"),u(10,"\uB9E4\uC7A5 \uC815\uBCF4"),a()(),o(11,"ion-card-content")(12,"ion-list")(13,"ion-item")(14,"ion-label")(15,"h3"),u(16,"\uB9E4\uC7A5\uBA85"),a(),d(17,Re,2,1,"p",24)(18,Oe,1,1,"ion-input",25),a()(),o(19,"ion-item")(20,"ion-label")(21,"h3"),u(22,"\uC704\uCE58"),a(),d(23,ke,2,1,"p",24)(24,Ae,1,1,"ion-input",26),a()(),o(25,"ion-item")(26,"ion-label")(27,"h3"),u(28,"\uAD6C\uB9E4 \uC77C\uC2DC"),a(),d(29,Le,3,4,"p",24)(30,Ve,1,1,"ion-datetime",27),a()()()()(),o(31,"ion-card")(32,"ion-card-header")(33,"ion-card-title"),u(34,"\uACB0\uC81C \uC815\uBCF4"),a()(),o(35,"ion-card-content")(36,"ion-grid")(37,"ion-row")(38,"ion-col",28)(39,"div",29)(40,"h4"),u(41,"\uC77C\uBCF8 \uC5D4\uD654"),a(),d(42,je,3,4,"p",30)(43,ze,1,1,"ion-input",31),a()(),o(44,"ion-col",28)(45,"div",29)(46,"h4"),u(47,"\uD55C\uAD6D \uC6D0\uD654"),a(),d(48,Je,3,6,"p",32)(49,Fe,1,1,"ion-input",31),a()()(),d(50,We,6,4,"ion-row",24),a()()(),d(51,He,22,4,"ion-card",24)(52,it,9,2,"ion-card",24)(53,nt,8,0,"ion-card",24)(54,pt,16,8,"ion-card",24),a()),t&2){let e=p();r(2),l("src",e.receipt.imageUrl),r(2),l("color",e.getStatusColor(e.receipt.processingStatus)),r(2),b(e.getStatusText(e.receipt.processingStatus)),r(11),l("ngIf",!e.isEditing),r(),l("ngIf",e.isEditing),r(5),l("ngIf",!e.isEditing),r(),l("ngIf",e.isEditing),r(5),l("ngIf",!e.isEditing),r(),l("ngIf",e.isEditing),r(12),l("ngIf",!e.isEditing),r(),l("ngIf",e.isEditing),r(5),l("ngIf",!e.isEditing),r(),l("ngIf",e.isEditing),r(),l("ngIf",e.receipt.totalAmountJpy&&e.receipt.totalAmountKrw),r(),l("ngIf",e.receipt.items&&e.receipt.items.length>0),r(),l("ngIf",e.receipt.items&&e.receipt.items.length>0),r(),l("ngIf",!e.receipt.items||e.receipt.items.length===0),r(),l("ngIf",e.receipt.processingStatus!=="completed")}}function dt(t,c){if(t&1){let e=x();o(0,"div",82),g(1,"ion-icon",83),o(2,"h2"),u(3,"\uC601\uC218\uC99D\uC744 \uCC3E\uC744 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4"),a(),o(4,"p"),u(5,"\uC694\uCCAD\uD558\uC2E0 \uC601\uC218\uC99D\uC774 \uC874\uC7AC\uD558\uC9C0 \uC54A\uAC70\uB098 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),a(),o(6,"ion-button",84),f("click",function(){_(e);let n=p();return m(n.goBack())}),u(7," \uBAA9\uB85D\uC73C\uB85C \uB3CC\uC544\uAC00\uAE30 "),a()()}}var yt=(()=>{let c=class c{constructor(i,n,s,C,D,we,ye,Te,Ee,Pe){this.route=i,this.router=n,this.receiptService=s,this.translationService=C,this.settingsService=D,this.actionSheetController=we,this.alertController=ye,this.toastController=Te,this.loadingController=Ee,this.modalController=Pe,this.receipt=null,this.isLoading=!0,this.isEditing=!1,this.editableReceipt={},this.translations=new Map,this.isTranslating=!1,this.showTranslationSettings=!1,this.translationSettings={sourceLanguage:"ja",targetLanguage:"ko",autoTranslateEnabled:!0},this.editingTranslations=new Map}ngOnInit(){let i=this.route.snapshot.paramMap.get("id");i&&this.loadReceipt(i),this.loadTranslationSettings()}loadReceipt(i){return h(this,null,function*(){this.isLoading=!0;try{this.receiptService.getReceiptById(i).subscribe({next:n=>{this.receipt=M(w({},n),{purchaseDate:new Date(n.purchaseDate)}),this.editableReceipt=w({},this.receipt),this.isLoading=!1,this.translationSettings.autoTranslateEnabled&&this.receipt.items&&this.receipt.items.length>0&&this.translateAllItems()},error:n=>{console.error("Error loading receipt:",n),this.showErrorToast("\uC601\uC218\uC99D\uC744 \uBD88\uB7EC\uC624\uB294\uB370 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."),this.isLoading=!1}})}catch(n){console.error("Error loading receipt:",n),this.showErrorToast("\uC601\uC218\uC99D\uC744 \uBD88\uB7EC\uC624\uB294\uB370 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."),this.isLoading=!1}})}presentActionSheet(){return h(this,null,function*(){yield(yield this.actionSheetController.create({header:"\uC601\uC218\uC99D \uAD00\uB9AC",buttons:[{text:"\uC218\uC815",icon:"create-outline",handler:()=>{this.toggleEdit()}},{text:"\uC0AD\uC81C",icon:"trash-outline",role:"destructive",handler:()=>{this.confirmDelete()}},{text:"\uACF5\uC720",icon:"share-outline",handler:()=>{this.shareReceipt()}},{text:"\uCDE8\uC18C",icon:"close",role:"cancel"}]})).present()})}toggleEdit(){this.isEditing=!this.isEditing,this.isEditing||(this.editableReceipt=w({},this.receipt))}saveChanges(){return h(this,null,function*(){if(!this.receipt||!this.editableReceipt)return;let i=yield this.loadingController.create({message:"\uC800\uC7A5 \uC911..."});yield i.present();try{this.receipt=w(w({},this.receipt),this.editableReceipt),this.isEditing=!1,yield i.dismiss(),this.showSuccessToast("\uC601\uC218\uC99D\uC774 \uC131\uACF5\uC801\uC73C\uB85C \uC218\uC815\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}catch{yield i.dismiss(),this.showErrorToast("\uC601\uC218\uC99D \uC218\uC815\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}confirmDelete(){return h(this,null,function*(){yield(yield this.alertController.create({header:"\uC601\uC218\uC99D \uC0AD\uC81C",message:"\uC774 \uC601\uC218\uC99D\uC744 \uC0AD\uC81C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C? \uC0AD\uC81C\uB41C \uC601\uC218\uC99D\uC740 \uBCF5\uAD6C\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.",buttons:[{text:"\uCDE8\uC18C",role:"cancel"},{text:"\uC0AD\uC81C",role:"destructive",handler:()=>{this.deleteReceipt()}}]})).present()})}deleteReceipt(){return h(this,null,function*(){if(!this.receipt)return;let i=yield this.loadingController.create({message:"\uC0AD\uC81C \uC911..."});yield i.present();try{this.receiptService.deleteReceipt(this.receipt.id).subscribe({next:()=>{i.dismiss(),this.showSuccessToast("\uC601\uC218\uC99D\uC774 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."),this.router.navigate(["/tabs/receipts"])},error:n=>{i.dismiss(),this.showErrorToast("\uC601\uC218\uC99D \uC0AD\uC81C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}catch{yield i.dismiss(),this.showErrorToast("\uC601\uC218\uC99D \uC0AD\uC81C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}shareReceipt(){this.receipt&&this.showInfoToast("\uACF5\uC720 \uAE30\uB2A5\uC740 \uC900\uBE44 \uC911\uC785\uB2C8\uB2E4.")}getStatusColor(i){switch(i){case"completed":return"success";case"processing":return"warning";case"failed":return"danger";case"pending":return"medium";default:return"medium"}}getStatusText(i){switch(i){case"completed":return"\uCC98\uB9AC \uC644\uB8CC";case"processing":return"\uCC98\uB9AC \uC911";case"failed":return"\uCC98\uB9AC \uC2E4\uD328";case"pending":return"\uCC98\uB9AC \uB300\uAE30";default:return"\uC54C \uC218 \uC5C6\uC74C"}}showSuccessToast(i){return h(this,null,function*(){(yield this.toastController.create({message:i,duration:2e3,position:"bottom",color:"success"})).present()})}showErrorToast(i){return h(this,null,function*(){(yield this.toastController.create({message:i,duration:3e3,position:"bottom",color:"danger"})).present()})}showInfoToast(i){return h(this,null,function*(){(yield this.toastController.create({message:i,duration:2e3,position:"bottom",color:"primary"})).present()})}goBack(){this.router.navigate(["/tabs/receipts"])}loadTranslationSettings(){let i=this.settingsService.getCurrentSettings();i?.translationSettings&&(this.translationSettings={sourceLanguage:i.translationSettings.sourceLanguage,targetLanguage:i.translationSettings.targetLanguage,autoTranslateEnabled:i.translationSettings.autoTranslateEnabled})}translateAllItems(){return h(this,null,function*(){if(!this.receipt?.items||this.receipt.items.length===0){this.showInfoToast("\uBC88\uC5ED\uD560 \uC0C1\uD488\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.isTranslating=!0;let i=yield this.loadingController.create({message:"\uC0C1\uD488\uBA85\uC744 \uBC88\uC5ED\uD558\uB294 \uC911..."});yield i.present();try{let n=this.receipt.items.filter(s=>this.translationService.needsTranslation(s.nameJp||s.name,this.translationSettings.sourceLanguage,this.translationSettings.targetLanguage)).map(s=>s.nameJp||s.name);if(n.length===0){yield i.dismiss(),this.isTranslating=!1,this.showInfoToast("\uBC88\uC5ED\uC774 \uD544\uC694\uD55C \uC0C1\uD488\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}this.translationService.batchTranslate(n,this.translationSettings.sourceLanguage,this.translationSettings.targetLanguage).subscribe({next:s=>{s.translations.forEach(C=>{this.translations.set(C.originalText,C)}),i.dismiss(),this.isTranslating=!1,this.showSuccessToast(`${s.successCount}\uAC1C \uC0C1\uD488\uBA85\uC774 \uBC88\uC5ED\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`)},error:s=>{console.error("Translation error:",s),i.dismiss(),this.isTranslating=!1,this.showErrorToast("\uBC88\uC5ED\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}catch{yield i.dismiss(),this.isTranslating=!1,this.showErrorToast("\uBC88\uC5ED \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}})}translateSingleItem(i){return h(this,null,function*(){if(!this.translationService.needsTranslation(i,this.translationSettings.sourceLanguage,this.translationSettings.targetLanguage))return;let n=this.translationService.getCachedTranslation(i,this.translationSettings.sourceLanguage,this.translationSettings.targetLanguage);if(n){this.translations.set(i,n);return}this.translationService.translateText(i,this.translationSettings.sourceLanguage,this.translationSettings.targetLanguage).subscribe({next:s=>{this.translations.set(i,s)},error:s=>{console.error("Single translation error:",s)}})})}getTranslatedText(i){return this.translations.get(i)?.translatedText||i}hasTranslation(i){return this.translations.has(i)}editTranslation(i){return h(this,null,function*(){let n=this.getTranslatedText(i);yield(yield this.alertController.create({header:"\uBC88\uC5ED \uC218\uC815",message:`\uC6D0\uBB38: ${i}`,inputs:[{name:"translation",type:"textarea",placeholder:"\uBC88\uC5ED\uC744 \uC785\uB825\uD558\uC138\uC694",value:n}],buttons:[{text:"\uCDE8\uC18C",role:"cancel"},{text:"\uC800\uC7A5",handler:C=>{C.translation&&C.translation.trim()!==""&&this.updateTranslation(i,C.translation.trim())}}]})).present()})}updateTranslation(i,n){let s=this.translations.get(i);s?this.translations.set(i,M(w({},s),{translatedText:n})):this.translations.set(i,{originalText:i,translatedText:n,sourceLanguage:this.translationSettings.sourceLanguage,targetLanguage:this.translationSettings.targetLanguage});let C={originalText:i,correctedTranslation:n,sourceLanguage:this.translationSettings.sourceLanguage,targetLanguage:this.translationSettings.targetLanguage};this.translationService.submitTranslationFeedback(C).subscribe({next:()=>{this.showSuccessToast("\uBC88\uC5ED\uC774 \uC218\uC815\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")},error:D=>{console.error("Translation feedback error:",D),this.showErrorToast("\uBC88\uC5ED \uC218\uC815 \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}presentTranslationSettings(){return h(this,null,function*(){let{TranslationSettingsModalComponent:i}=yield import("./chunk-B3E7EI7J.js"),n=yield this.modalController.create({component:i,presentingElement:yield this.modalController.getTop()});return n.onDidDismiss().then(s=>{s.data&&(this.translationSettings=s.data,this.loadTranslationSettings())}),yield n.present()})}saveTranslationSettings(){let i=this.settingsService.getCurrentSettings();i&&this.settingsService.updateTranslationSettings(i.id,this.translationSettings).subscribe({next:()=>{this.showSuccessToast("\uBC88\uC5ED \uC124\uC815\uC774 \uC800\uC7A5\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")},error:n=>{console.error("Settings update error:",n),this.showErrorToast("\uC124\uC815 \uC800\uC7A5\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}toggleAutoTranslate(){this.translationSettings.autoTranslateEnabled=!this.translationSettings.autoTranslateEnabled,this.saveTranslationSettings(),this.translationSettings.autoTranslateEnabled&&this.receipt?.items&&this.translateAllItems()}presentTranslationFeedback(i){return h(this,null,function*(){let n=this.getTranslatedText(i);yield(yield this.alertController.create({header:"\uBC88\uC5ED \uD488\uC9C8 \uD3C9\uAC00",message:`\uC6D0\uBB38: ${i}
\uBC88\uC5ED: ${n}`,inputs:[{name:"rating",type:"radio",label:"\uB9E4\uC6B0 \uC88B\uC74C",value:"5",checked:!1},{name:"rating",type:"radio",label:"\uC88B\uC74C",value:"4",checked:!0},{name:"rating",type:"radio",label:"\uBCF4\uD1B5",value:"3",checked:!1},{name:"rating",type:"radio",label:"\uB098\uC068",value:"2",checked:!1},{name:"rating",type:"radio",label:"\uB9E4\uC6B0 \uB098\uC068",value:"1",checked:!1}],buttons:[{text:"\uCDE8\uC18C",role:"cancel"},{text:"\uC218\uC815\uD558\uAE30",handler:()=>{this.editTranslation(i)}},{text:"\uD3C9\uAC00 \uC81C\uCD9C",handler:C=>{C&&this.submitRating(i,parseInt(C))}}]})).present()})}submitRating(i,n){let s={originalText:i,correctedTranslation:this.getTranslatedText(i),sourceLanguage:this.translationSettings.sourceLanguage,targetLanguage:this.translationSettings.targetLanguage,rating:n};this.translationService.submitTranslationFeedback(s).subscribe({next:()=>{this.showSuccessToast("\uD3C9\uAC00\uAC00 \uC81C\uCD9C\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")},error:C=>{console.error("Rating submission error:",C),this.showErrorToast("\uD3C9\uAC00 \uC81C\uCD9C\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4.")}})}};c.\u0275fac=function(n){return new(n||c)(S(z),S(J),S(ve),S(Se),S(be),S(de),S(ge),S(me),S(_e),S(ue))},c.\u0275cmp=R({type:c,selectors:[["app-receipt-detail"]],decls:15,vars:8,consts:[[3,"translucent"],["slot","start"],[3,"click"],["name","arrow-back"],["slot","end"],[3,"click",4,"ngIf"],["color","primary",3,"click",4,"ngIf"],["fill","clear",3,"click",4,"ngIf"],[3,"fullscreen"],["class","loading-container",4,"ngIf"],["class","receipt-detail-container",4,"ngIf"],["class","error-state",4,"ngIf"],["name","ellipsis-vertical"],["color","primary",3,"click"],["name","checkmark"],["fill","clear",3,"click"],["name","close"],[1,"loading-container"],["name","crescent"],[1,"receipt-detail-container"],[1,"receipt-image-card"],["alt","\uC601\uC218\uC99D \uC774\uBBF8\uC9C0",3,"src"],[1,"image-overlay"],[3,"color"],[4,"ngIf"],["placeholder","\uB9E4\uC7A5\uBA85\uC744 \uC785\uB825\uD558\uC138\uC694",3,"ngModel","ngModelChange",4,"ngIf"],["placeholder","\uB9E4\uC7A5 \uC704\uCE58\uB97C \uC785\uB825\uD558\uC138\uC694",3,"ngModel","ngModelChange",4,"ngIf"],["presentation","date-time",3,"ngModel","ngModelChange",4,"ngIf"],["size","6"],[1,"amount-info"],["class","amount-jpy",4,"ngIf"],["type","number","placeholder","0",3,"ngModel","ngModelChange",4,"ngIf"],["class","amount-krw",4,"ngIf"],["placeholder","\uB9E4\uC7A5\uBA85\uC744 \uC785\uB825\uD558\uC138\uC694",3,"ngModelChange","ngModel"],["placeholder","\uB9E4\uC7A5 \uC704\uCE58\uB97C \uC785\uB825\uD558\uC138\uC694",3,"ngModelChange","ngModel"],["presentation","date-time",3,"ngModelChange","ngModel"],[1,"amount-jpy"],["type","number","placeholder","0",3,"ngModelChange","ngModel"],[1,"amount-krw"],["size","12"],[1,"exchange-rate-info"],["slot","end",3,"ngModelChange","ionChange","ngModel"],["expand","block","fill","outline",3,"click","disabled"],["name","language","slot","start"],["expand","block","fill","clear","size","small",3,"click"],["name","settings","slot","start"],["color","primary"],[4,"ngFor","ngForOf"],[1,"product-names"],["class","translated-name",4,"ngIf"],["class","korean-name",4,"ngIf"],["class","original-name",4,"ngIf"],["class","japanese-name",4,"ngIf"],[1,"item-prices"],[1,"price-jpy"],[1,"price-separator"],[1,"price-krw"],["class","product-code",4,"ngIf"],["slot","end",1,"translation-actions"],["color","medium","size","small",4,"ngIf"],["fill","clear","size","small",3,"click",4,"ngIf"],[1,"translated-name"],["color","success","size","small"],["name","language","size","small"],[1,"korean-name"],[1,"original-name"],[1,"japanese-name"],["fill","clear","size","small",3,"click"],[1,"product-code"],["color","medium","size","small"],["name","star-outline","size","small"],["name","create-outline","size","small"],[1,"empty-items-state"],["name","receipt-outline","size","large"],[1,"processing-status"],["name","time",4,"ngIf"],["name","sync",4,"ngIf"],["name","alert-circle",4,"ngIf"],[1,"status-description"],["name","time"],["name","sync"],["name","alert-circle"],[1,"error-state"],["name","alert-circle-outline","size","large"],["fill","outline",3,"click"]],template:function(n,s){n&1&&(o(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),f("click",function(){return s.goBack()}),g(4,"ion-icon",3),a()(),o(5,"ion-title"),u(6,"\uC601\uC218\uC99D \uC0C1\uC138"),a(),o(7,"ion-buttons",4),d(8,Ie,2,0,"ion-button",5)(9,De,2,0,"ion-button",6)(10,Me,2,0,"ion-button",7),a()()(),o(11,"ion-content",8),d(12,Be,4,0,"div",9)(13,ut,55,18,"div",10)(14,dt,8,0,"div",11),a()),n&2&&(l("translucent",!0),r(8),l("ngIf",s.receipt&&!s.isEditing),r(),l("ngIf",s.isEditing),r(),l("ngIf",s.isEditing),r(),l("fullscreen",!0),r(),l("ngIf",s.isLoading),r(),l("ngIf",!s.isLoading&&s.receipt),r(),l("ngIf",!s.isLoading&&!s.receipt))},dependencies:[j,O,k,K,F,W,te,pe,le,Z,$,H,he,q,U,Q,G,ne,ae,oe,re,X,ie,ee,se,Y,ce,N,xe,Ce,fe,L,V,A],styles:[".loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:50vh;text-align:center;color:var(--ion-color-medium)}.loading-container[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{margin-bottom:16px}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9em}.receipt-detail-container[_ngcontent-%COMP%]{padding:16px 16px 80px}.receipt-image-card[_ngcontent-%COMP%]{position:relative;margin-bottom:16px}.receipt-image-card[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:100%;height:300px;object-fit:cover;border-radius:8px}.receipt-image-card[_ngcontent-%COMP%]   .image-overlay[_ngcontent-%COMP%]{position:absolute;top:12px;right:12px;z-index:1}.receipt-image-card[_ngcontent-%COMP%]   .image-overlay[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{--background: rgba(255, 255, 255, .9);--color: var(--ion-color-dark);-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.amount-info[_ngcontent-%COMP%]{text-align:center;padding:16px 8px}.amount-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-size:.9em;color:var(--ion-color-medium);font-weight:500}.amount-info[_ngcontent-%COMP%]   .amount-jpy[_ngcontent-%COMP%], .amount-info[_ngcontent-%COMP%]   .amount-krw[_ngcontent-%COMP%]{font-size:1.5em;font-weight:600;margin:0}.amount-info[_ngcontent-%COMP%]   .amount-jpy[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.amount-info[_ngcontent-%COMP%]   .amount-krw[_ngcontent-%COMP%]{color:var(--ion-color-success)}.product-names[_ngcontent-%COMP%]{margin-bottom:4px}.product-names[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 2px;font-weight:600;color:var(--ion-color-dark)}.product-names[_ngcontent-%COMP%]   .translated-name[_ngcontent-%COMP%]{color:var(--ion-color-success);display:flex;align-items:center;gap:4px}.product-names[_ngcontent-%COMP%]   .translated-name[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{--padding-start: 4px;--padding-end: 4px;height:20px;font-size:.7em}.product-names[_ngcontent-%COMP%]   .korean-name[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.product-names[_ngcontent-%COMP%]   .original-name[_ngcontent-%COMP%]{color:var(--ion-color-dark)}.product-names[_ngcontent-%COMP%]   .japanese-name[_ngcontent-%COMP%]{margin:0 0 4px;font-size:.85em;color:var(--ion-color-medium);font-style:italic;display:flex;align-items:center;gap:4px}.product-names[_ngcontent-%COMP%]   .japanese-name[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start: 4px;--padding-end: 4px;height:24px;margin:0}.item-prices[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:4px}.item-prices[_ngcontent-%COMP%]   .price-jpy[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:500;font-size:.9em}.item-prices[_ngcontent-%COMP%]   .price-separator[_ngcontent-%COMP%]{color:var(--ion-color-light);font-weight:300}.item-prices[_ngcontent-%COMP%]   .price-krw[_ngcontent-%COMP%]{color:var(--ion-color-success);font-weight:500;font-size:.9em}.translation-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:4px}.translation-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start: 8px;--padding-end: 8px;height:32px;margin:0}.empty-items-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:40px 20px;color:var(--ion-color-medium)}.empty-items-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-bottom:16px;opacity:.5}.empty-items-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:8px 0;font-weight:500;color:var(--ion-color-dark)}.empty-items-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9em}ion-card[_ngcontent-%COMP%]{margin-bottom:16px;border-radius:12px;box-shadow:0 2px 8px #0000001a}@media (max-width: 768px){.receipt-detail-container[_ngcontent-%COMP%]{padding:12px}.receipt-image-card[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{height:250px}.amount-info[_ngcontent-%COMP%]{padding:12px 4px}}"]});let t=c;return t})();export{yt as ReceiptDetailPage};
